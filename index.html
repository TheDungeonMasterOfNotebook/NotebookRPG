<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Notebook RPG ‚Äî Create Character</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* small helper to ensure class button visuals (keeps with your style.css) */
    .classOption { cursor:pointer; user-select:none; }
    .classOption.selected { box-shadow: 0 0 8px #ffd700 inset; transform: translateY(-2px); }
  </style>
</head>
<body>
  <!-- Biome background / particles still present for visual continuity -->
  <div id="biomeBackground"></div>
  <div id="particleLayer"></div>

  <!-- Character Creation Panel (inline) -->
  <div id="characterCreation" class="panel" style="max-width:700px;margin:60px auto;">
    <h1>üìñ The Notebook Opens...</h1>
    <p>A new story begins. What is your name, traveler?</p>

    <input id="charName" type="text" placeholder="Enter your name..." maxlength="18" style="width:70%;padding:8px;border-radius:6px;border:1px solid #444;background:#111;color:#fff" />

    <p style="margin-top:14px">Choose your class:</p>
    <div id="classList" style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center;"></div>

    <p style="margin-top:12px">Choose your symbol (optional):</p>
    <input id="charEmoji" type="text" placeholder="e.g. ‚öîÔ∏è üê∫ ü™Ñ" maxlength="3" style="width:40%;padding:8px;border-radius:6px;border:1px solid #444;background:#111;color:#fff" />

    <div style="margin-top:18px">
      <button id="beginAdventure" style="padding:10px 20px;background:#222;border:2px solid #ffd700;color:#ffd700;border-radius:8px;cursor:pointer">‚úèÔ∏è Begin Adventure</button>
    </div>

    <div id="creationNote" class="small" style="margin-top:10px;color:#aaa"></div>
  </div>

  <!-- Main game container (hidden until created) -->
  <div id="gameContainer" class="hidden">
    <h1 id="gameTitle">üìò Notebook RPG</h1>
    <div id="gameUI"></div>
  </div>

  <!-- Floating / modals / admin -->
  <div id="floatLayer"></div>
  <div id="modalContainer"></div>

  <!-- Admin markup (kept for developer use) -->
  <div id="adminPanel" class="hidden">
    <h2>‚öôÔ∏è Admin Panel</h2>
    <div id="adminContent">
      <label>Player Name: <input id="adminName" type="text" /></label>
      <label>Level: <input id="adminLevel" type="number" /></label>
      <label>XP: <input id="adminXP" type="number" /></label>
      <label>HP: <input id="adminHP" type="number" /></label>
      <label>Ace Currency: <input id="adminAces" type="number" /></label>
      <button id="adminSave">üíæ Save Changes</button>
      <hr/>
      <button id="spawnLoot">üéÅ Spawn Random Loot</button>
      <button id="addXP">‚ö° Add 100 XP</button>
      <button id="healFull">‚ù§Ô∏è Full Heal</button>
      <button id="resetGame">üíÄ Reset Game</button>
    </div>
  </div>

<script>
/*
  Character creation wiring script
  - Uses the same class definitions you use in game.js
  - Writes player object to localStorage key 'notebookSave'
  - Then reloads page so game.js (which reads notebookSave) loads this player
*/

const CLASSES = {
  Knight:    { hp: 120, atk: 10, def: 10, spd: 5, trait: "Extra armor on start" },
  Rogue:     { hp: 90,  atk: 8,  def: 5,  spd: 12, trait: "Higher crit chance" },
  Mage:      { hp: 80,  atk: 14, def: 4,  spd: 8,  trait: "Bonus magic damage" },
  Ranger:    { hp: 100, atk: 10, def: 6,  spd: 10, trait: "High accuracy" },
  Cleric:    { hp: 95,  atk: 7,  def: 8,  spd: 7,  trait: "Self-heal every 3 turns" },
  Berserker: { hp: 110, atk: 12, def: 5,  spd: 9,  trait: "More damage at low HP" },
  Necromancer:{hp:85,  atk: 9,  def:5,  spd:7,  trait: "Can summon skeletons" },
  Paladin:   { hp:115, atk:10, def:9,  spd:6,  trait: "Light damage resist" }
};

const classListEl = document.getElementById('classList');
let selectedClass = null;

// render class buttons
Object.keys(CLASSES).forEach(cls => {
  const btn = document.createElement('div');
  btn.className = 'classOption';
  btn.textContent = cls;
  btn.title = CLASSES[cls].trait;
  btn.style.padding = '8px 12px';
  btn.style.border = '1px solid #444';
  btn.style.borderRadius = '8px';
  btn.style.background = '#111';
  btn.style.color = '#fff';
  btn.addEventListener('click', () => {
    // deselect others
    document.querySelectorAll('.classOption').forEach(x => x.classList.remove('selected'));
    btn.classList.add('selected');
    selectedClass = cls;
    document.getElementById('creationNote').textContent = `${cls} ‚Äî ${CLASSES[cls].trait} ‚Ä¢ HP ${CLASSES[cls].hp}, ATK ${CLASSES[cls].atk}`;
  });
  classListEl.appendChild(btn);
});

// Begin Adventure handler: validate, create save object, store and reload
document.getElementById('beginAdventure').addEventListener('click', () => {
  const name = document.getElementById('charName').value.trim();
  const emoji = document.getElementById('charEmoji').value.trim() || '';
  if (!name) { alert('Please enter a name.'); return; }
  if (!selectedClass) { alert('Please select a class.'); return; }

  const def = CLASSES[selectedClass];
  // Build player object matching game.js expected structure (key names used in the game.js you have)
  const player = {
    name,
    emoji,
    class: selectedClass,
    level: 1,
    xp: 0,
    nextXP: Math.max(100, Math.floor(120 * Math.pow(1, 1.5))),
    hp: def.hp,
    maxHP: def.hp,
    atk: def.atk,
    atkBase: def.atk,
    def: def.def,
    spd: def.spd,
    crit: (selectedClass === 'Rogue' ? 13 : 5),
    aces: { Spades:0, Hearts:0, Diamonds:0, Clubs:0 },
    inventory: [],
    equipment: { Weapon:null, Armor:null, Accessory:null },
    status: []
  };

  // Save under the key game.js loads from
  localStorage.setItem('notebookSave', JSON.stringify(player));

  // Small UX: hide creation, show game container (game.js will pick up on reload),
  // reload so the game script reads the saved player and initializes properly.
  location.reload();
});

// quick helper: if a save already exists, skip creation UI and show game container
(function autoSkipIfSaved(){
  if (localStorage.getItem('notebookSave')) {
    // hide creation and show main container, game.js will actually render
    document.getElementById('characterCreation').classList.add('hidden');
    document.getElementById('gameContainer').classList.remove('hidden');
  }
})();
</script>
</body>
</html>
